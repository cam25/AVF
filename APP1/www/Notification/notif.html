<!DOCTYPE html>
<html>
<head>
<meta name = "viewport" content = "width = device-width"/>
<title>Local Twitter Search</title>
        <script src="http://code.jquery.com/jquery-1.8.2.js"></script>

<script type="text/javascript">
    function gotGps(){
        var gps = navigator.geolocation;
        if (gps){
            gps.getCurrentPosition(twitterSearch,
                   function(error){
                alert("Got an error, code: " + error.code + " message: "
+ error.message);
             });
        } else {
            twitterSearch();
        }
    }
    function twitterSearch(position){
        var query = "http://search.twitter.com/search.json?q=google&rpp=5&include_entities=true&result_type=mixed?callback=?"+ query;

         query += document.getElementsByName("kwBox").value;
        console.log(kwBox.value);
        console.log(query)
        if (position){
            var lat = position.coords.latitude;
            var long = position.coords.longitude;
            query += "&geocode=" + escape(lat + "," + long + ",50mi");
        }
        var script = document.createElement("script");
        script.src = query;
        document.getElementsByTagName("head")[0].appendChild(script);
        console.log(script.src);
    }
</script>
</head>
<body>
    <div id="main">
    <FORM NAME="myform" ACTION="" METHOD="GET">
        <label for="kwBox">Search Twitter:</label>
        <input type="text" name="kwBox" id="kwBox"/>
        <input type="button" value="Go!" onclick="gotGps()"/>
    </FORM>
    </div>
    <div id="results">
    </div>
</body>
</html>